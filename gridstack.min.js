!function(t){if("function"==typeof define&&define.amd)define(["jquery","lodash","jquery-ui/core","jquery-ui/widget","jquery-ui/mouse","jquery-ui/draggable","jquery-ui/resizable"],t);else if("undefined"!=typeof exports){try{jQuery=require("jquery")}catch(e){}try{_=require("lodash")}catch(e){}t(jQuery,_)}else t(jQuery,_)}(function(t,e){var i=window,o=function(t,e,i){var o=function(){return console.warn("gridstack.js: Function `"+e+"` is deprecated as of v0.2.5 and has been replaced with `"+i+"`. It will be **completely** removed in v1.0."),t.apply(this,arguments)};return o.prototype=t.prototype,o},s=function(t,e){console.warn("gridstack.js: Option `"+t+"` is deprecated as of v0.2.5 and has been replaced with `"+e+"`. It will be **completely** removed in v1.0.")},a={isIntercepted:function(t,e){return!(t.x+t.width<=e.x||e.x+e.width<=t.x||t.y+t.height<=e.y||e.y+e.height<=t.y)},sort:function(t,i,o){return o=o||e.chain(t).map(function(t){return t.x+t.width}).max().value(),i=-1!=i?1:-1,e.sortBy(t,function(t){return i*(t.x+t.y*o)})},createStylesheet:function(t){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.setAttribute("data-gs-style-id",t),e.styleSheet?e.styleSheet.cssText="":e.appendChild(document.createTextNode("")),document.getElementsByTagName("head")[0].appendChild(e),e.sheet},removeStylesheet:function(e){t("STYLE[data-gs-style-id="+e+"]").remove()},insertCSSRule:function(t,e,i,o){"function"==typeof t.insertRule?t.insertRule(e+"{"+i+"}",o):"function"==typeof t.addRule&&t.addRule(e,i,o)},toBool:function(t){return"boolean"==typeof t?t:"string"==typeof t?(t=t.toLowerCase(),!(""===t||"no"==t||"false"==t||"0"==t)):Boolean(t)},_collisionNodeCheck:function(t){return t!=this.node&&a.isIntercepted(t,this.nn)},_didCollide:function(t){return a.isIntercepted({x:this.n.x,y:this.newY,width:this.n.width,height:this.n.height},t)},_isAddNodeIntercepted:function(t){return a.isIntercepted({x:this.x,y:this.y,width:this.node.width,height:this.node.height},t)},parseHeight:function(t){var i=t,o="px";if(i&&e.isString(i)){var s=i.match(/^([0-9]*\.[0-9]+|[0-9]+)(px|em|rem|vh|vw)?$/);if(!s)throw new Error("Invalid height");o=s[2]||"px",i=parseFloat(s[1])}return{height:i,unit:o}}};a.is_intercepted=o(a.isIntercepted,"is_intercepted","isIntercepted"),a.create_stylesheet=o(a.createStylesheet,"create_stylesheet","createStylesheet"),a.remove_stylesheet=o(a.removeStylesheet,"remove_stylesheet","removeStylesheet"),a.insert_css_rule=o(a.insertCSSRule,"insert_css_rule","insertCSSRule");var n=0,r=function(t,e,i,o,s){this.width=t,this["float"]=i||!1,this.height=o||0,this.nodes=s||[],this.onchange=e||function(){},this._updateCounter=0,this._float=this["float"],this._addedNodes=[],this._removedNodes=[]};r.prototype.batchUpdate=function(){this._updateCounter=1,this["float"]=!0},r.prototype.commit=function(){0!==this._updateCounter&&(this._updateCounter=0,this["float"]=this._float,this._packNodes(),this._notify())},r.prototype.getNodeDataByDOMEl=function(t){return e.find(this.nodes,function(e){return t.get(0)===e.el.get(0)})},r.prototype._fixCollisions=function(t){this._sortNodes(-1);var i=t,o=Boolean(e.find(this.nodes,function(t){return t.locked}));for(this["float"]||o||(i={x:0,y:t.y,width:this.width,height:t.height});;){var s=e.find(this.nodes,e.bind(a._collisionNodeCheck,{node:t,nn:i}));if("undefined"==typeof s)return;this.moveNode(s,s.x,t.y+t.height,s.width,s.height,!0)}},r.prototype.isAreaEmpty=function(t,i,o,s){var n={x:t||0,y:i||0,width:o||1,height:s||1},r=e.find(this.nodes,e.bind(function(t){return a.isIntercepted(t,n)},this));return null===r||"undefined"==typeof r},r.prototype._sortNodes=function(t){this.nodes=a.sort(this.nodes,t,this.width)},r.prototype._packNodes=function(){this._sortNodes(),this["float"]?e.each(this.nodes,e.bind(function(t,i){if(!t._updating&&"undefined"!=typeof t._origY&&t.y!=t._origY)for(var o=t.y;o>=t._origY;){var s=e.chain(this.nodes).find(e.bind(a._didCollide,{n:t,newY:o})).value();s||(t._dirty=!0,t.y=o),--o}},this)):e.each(this.nodes,e.bind(function(t,i){if(!t.locked)for(;t.y>0;){var o=t.y-1,s=0===i;if(i>0){var n=e.chain(this.nodes).take(i).find(e.bind(a._didCollide,{n:t,newY:o})).value();s="undefined"==typeof n}if(!s)break;t._dirty=t.y!=o,t.y=o}},this))},r.prototype._prepareNode=function(t,i){return t=e.defaults(t||{},{width:1,height:1,x:0,y:0}),t.x=parseInt(""+t.x),t.y=parseInt(""+t.y),t.width=parseInt(""+t.width),t.height=parseInt(""+t.height),t.autoPosition=t.autoPosition||!1,t.noResize=t.noResize||!1,t.noMove=t.noMove||!1,t.width>this.width?t.width=this.width:t.width<1&&(t.width=1),t.height<1&&(t.height=1),t.x<0&&(t.x=0),t.x+t.width>this.width&&(i?t.width=this.width-t.x:t.x=this.width-t.width),t.y<0&&(t.y=0),t},r.prototype._notify=function(){if(!this._updateCounter){var t=Array.prototype.slice.call(arguments,0);t=t.concat(this.getDirtyNodes()),this.onchange(t)}},r.prototype.cleanNodes=function(){this._updateCounter||e.each(this.nodes,function(t){t._dirty=!1})},r.prototype.getDirtyNodes=function(){return e.filter(this.nodes,function(t){return t._dirty})},r.prototype.addNode=function(t,i){if(t=this._prepareNode(t),"undefined"!=typeof t.maxWidth&&(t.width=Math.min(t.width,t.maxWidth)),"undefined"!=typeof t.maxHeight&&(t.height=Math.min(t.height,t.maxHeight)),"undefined"!=typeof t.minWidth&&(t.width=Math.max(t.width,t.minWidth)),"undefined"!=typeof t.minHeight&&(t.height=Math.max(t.height,t.minHeight)),t._id=++n,t._dirty=!0,t.autoPosition){this._sortNodes();for(var o=0;;++o){var s=o%this.width,r=Math.floor(o/this.width);if(!(s+t.width>this.width||e.find(this.nodes,e.bind(a._isAddNodeIntercepted,{x:s,y:r,node:t})))){t.x=s,t.y=r;break}}}return this.nodes.push(t),"undefined"!=typeof i&&i&&this._addedNodes.push(e.clone(t)),this._fixCollisions(t),this._packNodes(),this._notify(),t},r.prototype.removeNode=function(t,i){i="undefined"==typeof i?!0:i,this._removedNodes.push(e.clone(t)),t._id=null,this.nodes=e.without(this.nodes,t),this._packNodes(),i&&this._notify(t)},r.prototype.canMoveNode=function(i,o,s,a,n){var d=Boolean(e.find(this.nodes,function(t){return t.locked}));if(!this.height&&!d)return!0;var h,l=new r(this.width,null,this["float"],0,e.map(this.nodes,function(e){return e==i?h=t.extend({},e):t.extend({},e)}));l.moveNode(h,o,s,a,n);var p=!0;return d&&(p&=!Boolean(e.find(l.nodes,function(t){return t!=h&&Boolean(t.locked)&&Boolean(t._dirty)}))),this.height&&(p&=l.getGridHeight()<=this.height),p},r.prototype.canBePlacedWithRespectToHeight=function(i){if(!this.height)return!0;var o=new r(this.width,null,this["float"],0,e.map(this.nodes,function(e){return t.extend({},e)}));return o.addNode(i),o.getGridHeight()<=this.height},r.prototype.moveNode=function(t,e,i,o,s,a){if("number"!=typeof e&&(e=t.x),"number"!=typeof i&&(i=t.y),"number"!=typeof o&&(o=t.width),"number"!=typeof s&&(s=t.height),"undefined"!=typeof t.maxWidth&&(o=Math.min(o,t.maxWidth)),"undefined"!=typeof t.maxHeight&&(s=Math.min(s,t.maxHeight)),"undefined"!=typeof t.minWidth&&(o=Math.max(o,t.minWidth)),"undefined"!=typeof t.minHeight&&(s=Math.max(s,t.minHeight)),t.x==e&&t.y==i&&t.width==o&&t.height==s)return t;var n=t.width!=o;return t._dirty=!0,t.x=e,t.y=i,t.width=o,t.height=s,t=this._prepareNode(t,n),this._fixCollisions(t),a||(this._packNodes(),this._notify()),t},r.prototype.getGridHeight=function(){return e.reduce(this.nodes,function(t,e){return Math.max(t,e.y+e.height)},0)},r.prototype.beginUpdate=function(t){e.each(this.nodes,function(t){t._origY=t.y}),t._updating=!0},r.prototype.endUpdate=function(){e.each(this.nodes,function(t){t._origY=t.y});var t=e.find(this.nodes,function(t){return t._updating});t&&(t._updating=!1)};var d=function(i,o){var a,n,d=this;o=o||{},this.container=t(i),"undefined"!=typeof o.handle_class&&(o.handleClass=o.handle_class,s("handle_class","handleClass")),"undefined"!=typeof o.item_class&&(o.itemClass=o.item_class,s("item_class","itemClass")),"undefined"!=typeof o.placeholder_class&&(o.placeholderClass=o.placeholder_class,s("placeholder_class","placeholderClass")),"undefined"!=typeof o.placeholder_text&&(o.placeholderText=o.placeholder_text,s("placeholder_text","placeholderText")),"undefined"!=typeof o.item_class&&(o.itemClass=o.item_class,s("item_class","itemClass")),"undefined"!=typeof o.cell_height&&(o.cellHeight=o.cell_height,s("cell_height","cellHeight")),"undefined"!=typeof o.vertical_margin&&(o.verticalMargin=o.vertical_margin,s("vertical_margin","verticalMargin")),"undefined"!=typeof o.min_width&&(o.minWidth=o.min_width,s("min_width","minWidth")),"undefined"!=typeof o.static_grid&&(o.staticGrid=o.static_grid,s("static_grid","staticGrid")),"undefined"!=typeof o.is_nested&&(o.isNested=o.is_nested,s("is_nested","isNested")),"undefined"!=typeof o.always_show_resize_handle&&(o.alwaysShowResizeHandle=o.always_show_resize_handle,s("always_show_resize_handle","alwaysShowResizeHandle")),o.itemClass=o.itemClass||"grid-stack-item";var h=this.container.closest("."+o.itemClass).size()>0;if(this.opts=e.defaults(o||{},{width:parseInt(this.container.attr("data-gs-width"))||12,height:parseInt(this.container.attr("data-gs-height"))||0,itemClass:"grid-stack-item",placeholderClass:"grid-stack-placeholder",placeholderText:"",handle:".grid-stack-item-content",handleClass:null,cellHeight:60,verticalMargin:20,auto:!0,minWidth:768,"float":!1,staticGrid:!1,_class:"grid-stack-instance-"+(1e4*Math.random()).toFixed(0),animate:Boolean(this.container.attr("data-gs-animate"))||!1,alwaysShowResizeHandle:o.alwaysShowResizeHandle||!1,resizable:e.defaults(o.resizable||{},{autoHide:!o.alwaysShowResizeHandle,handles:"se"}),draggable:e.defaults(o.draggable||{},{handle:(o.handleClass?"."+o.handleClass:o.handle?o.handle:"")||".grid-stack-item-content",scroll:!1,appendTo:"body"}),disableDrag:o.disableDrag||!1,disableResize:o.disableResize||!1,rtl:"auto",removable:!1,removeTimeout:2e3}),"auto"===this.opts.rtl&&(this.opts.rtl="rtl"===this.container.css("direction")),this.opts.rtl&&this.container.addClass("grid-stack-rtl"),this.opts.isNested=h,n="auto"===this.opts.cellHeight,n?d.cellHeight(d.cellWidth(),!0):this.cellHeight(this.opts.cellHeight,!0),this.verticalMargin(this.opts.verticalMargin,!0),this.container.addClass(this.opts._class),this._setStaticClass(),h&&this.container.addClass("grid-stack-nested"),this._initStyles(),this.grid=new r(this.opts.width,function(t){var i=0;e.each(t,function(t){null===t._id?t.el.remove():(t.el.attr("data-gs-x",t.x).attr("data-gs-y",t.y).attr("data-gs-width",t.width).attr("data-gs-height",t.height),i=Math.max(i,t.y+t.height))}),d._updateStyles(i+10)},this.opts["float"],this.opts.height),this.opts.auto){var l=[],p=this;this.container.children("."+this.opts.itemClass+":not(."+this.opts.placeholderClass+")").each(function(e,i){i=t(i),l.push({el:i,i:parseInt(i.attr("data-gs-x"))+parseInt(i.attr("data-gs-y"))*p.opts.width})}),e.chain(l).sortBy(function(t){return t.i}).each(function(t){d._prepareElement(t.el)}).value()}if(this.setAnimation(this.opts.animate),this.placeholder=t('<div class="'+this.opts.placeholderClass+" "+this.opts.itemClass+'"><div class="placeholder-content">'+this.opts.placeholderText+"</div></div>").hide(),this._updateContainerHeight(),this._updateHeightsOnResize=e.throttle(function(){d.cellHeight(d.cellWidth(),!1)},100),this.onResizeHandler=function(){if(n&&d._updateHeightsOnResize(),d._isOneColumnMode()){if(a)return;a=!0,d.grid._sortNodes(),e.each(d.grid.nodes,function(t){d.container.append(t.el),d.opts.staticGrid||((t.noMove||d.opts.disableDrag)&&t.el.draggable("disable"),(t.noResize||d.opts.disableResize)&&t.el.resizable("disable"))})}else{if(!a)return;if(a=!1,d.opts.staticGrid)return;e.each(d.grid.nodes,function(t){t.noMove||d.opts.disableDrag||t.el.draggable("enable"),t.noResize||d.opts.disableResize||t.el.resizable("enable")})}},t(window).resize(this.onResizeHandler),this.onResizeHandler(),"string"==typeof d.opts.removable){var c=t(d.opts.removable);c.data("droppable")||c.droppable({}),c.on("dropover",function(e,i){var o=t(i.draggable),s=o.data("_gridstack_node");s._grid===d&&d._setupRemovingTimeout(o)}).on("dropout",function(e,i){var o=t(i.draggable),s=o.data("_gridstack_node");s._grid===d&&d._clearRemovingTimeout(o)})}};return d.prototype._triggerChangeEvent=function(t){var e=this.grid.getDirtyNodes(),i=!1,o=[];e&&e.length&&(o.push(e),i=!0),(i||t===!0)&&this.container.trigger("change",o)},d.prototype._triggerAddEvent=function(){this.grid._addedNodes&&this.grid._addedNodes.length>0&&(this.container.trigger("added",[e.map(this.grid._addedNodes,e.clone)]),this.grid._addedNodes=[])},d.prototype._triggerRemoveEvent=function(){this.grid._removedNodes&&this.grid._removedNodes.length>0&&(this.container.trigger("removed",[e.map(this.grid._removedNodes,e.clone)]),this.grid._removedNodes=[])},d.prototype._initStyles=function(){this._stylesId&&a.removeStylesheet(this._stylesId),this._stylesId="gridstack-style-"+(1e5*Math.random()).toFixed(),this._styles=a.createStylesheet(this._stylesId),null!==this._styles&&(this._styles._max=0)},d.prototype._updateStyles=function(t){if(null!==this._styles&&"undefined"!=typeof this._styles){var e,i="."+this.opts._class+" ."+this.opts.itemClass,o=this;if("undefined"==typeof t&&(t=this._styles._max,this._initStyles(),this._updateContainerHeight()),this.opts.cellHeight&&!(0!==this._styles._max&&t<=this._styles._max)&&(e=this.opts.verticalMargin&&this.opts.cellHeightUnit!==this.opts.verticalMarginUnit?function(t,e){return t&&e?"calc("+(o.opts.cellHeight*t+o.opts.cellHeightUnit)+" + "+(o.opts.verticalMargin*e+o.opts.verticalMarginUnit)+")":o.opts.cellHeight*t+o.opts.verticalMargin*e+o.opts.cellHeightUnit}:function(t,e){return o.opts.cellHeight*t+o.opts.verticalMargin*e+o.opts.cellHeightUnit},0===this._styles._max&&a.insertCSSRule(this._styles,i,"min-height: "+e(1,0)+";",0),t>this._styles._max)){for(var s=this._styles._max;t>s;++s)a.insertCSSRule(this._styles,i+'[data-gs-height="'+(s+1)+'"]',"height: "+e(s+1,s)+";",s),a.insertCSSRule(this._styles,i+'[data-gs-min-height="'+(s+1)+'"]',"min-height: "+e(s+1,s)+";",s),a.insertCSSRule(this._styles,i+'[data-gs-max-height="'+(s+1)+'"]',"max-height: "+e(s+1,s)+";",s),a.insertCSSRule(this._styles,i+'[data-gs-y="'+s+'"]',"top: "+e(s,s)+";",s);this._styles._max=t}}},d.prototype._updateContainerHeight=function(){if(!this.grid._updateCounter){var t=this.grid.getGridHeight();this.container.attr("data-gs-current-height",t),this.opts.cellHeight&&(this.opts.verticalMargin?this.opts.cellHeightUnit===this.opts.verticalMarginUnit?this.container.css("height",t*(this.opts.cellHeight+this.opts.verticalMargin)-this.opts.verticalMargin+this.opts.cellHeightUnit):this.container.css("height","calc("+(t*this.opts.cellHeight+this.opts.cellHeightUnit)+" + "+(t*(this.opts.verticalMargin-1)+this.opts.verticalMarginUnit)+")"):this.container.css("height",t*this.opts.cellHeight+this.opts.cellHeightUnit))}},d.prototype._isOneColumnMode=function(){return(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<=this.opts.minWidth},d.prototype._setupRemovingTimeout=function(e){var i=this,o=t(e).data("_gridstack_node");!o._removeTimeout&&i.opts.removable&&(o._removeTimeout=setTimeout(function(){e.addClass("grid-stack-item-removing"),o._isAboutToRemove=!0},i.opts.removeTimeout))},d.prototype._clearRemovingTimeout=function(e){var i=t(e).data("_gridstack_node");i._removeTimeout&&(clearTimeout(i._removeTimeout),i._removeTimeout=null,e.removeClass("grid-stack-item-removing"),i._isAboutToRemove=!1)},d.prototype._prepareElement=function(i,o){o="undefined"!=typeof o?o:!1;var s=this;i=t(i),i.addClass(this.opts.itemClass);var n=s.grid.addNode({x:i.attr("data-gs-x"),y:i.attr("data-gs-y"),width:i.attr("data-gs-width"),height:i.attr("data-gs-height"),maxWidth:i.attr("data-gs-max-width"),minWidth:i.attr("data-gs-min-width"),maxHeight:i.attr("data-gs-max-height"),minHeight:i.attr("data-gs-min-height"),autoPosition:a.toBool(i.attr("data-gs-auto-position")),noResize:a.toBool(i.attr("data-gs-no-resize")),noMove:a.toBool(i.attr("data-gs-no-move")),locked:a.toBool(i.attr("data-gs-locked")),el:i,id:i.attr("data-gs-id"),_grid:s},o);i.data("_gridstack_node",n);var r,d,h=function(t,e){var o,a,h=Math.round(e.position.left/r),l=Math.floor((e.position.top+d/2)/d);if("drag"!=t.type&&(o=Math.round(e.size.width/r),a=Math.round(e.size.height/d)),"drag"==t.type)0>h||h>=s.grid.width||0>l?(s.opts.removable===!0&&s._setupRemovingTimeout(i),h=n._beforeDragX,l=n._beforeDragY,s.placeholder.detach(),s.placeholder.hide(),s.grid.removeNode(n),s._updateContainerHeight(),n._temporaryRemoved=!0):(s._clearRemovingTimeout(i),n._temporaryRemoved&&(s.grid.addNode(n),s.placeholder.attr("data-gs-x",h).attr("data-gs-y",l).attr("data-gs-width",o).attr("data-gs-height",a).show(),s.container.append(s.placeholder),n.el=s.placeholder,n._temporaryRemoved=!1));else if("resize"==t.type&&0>h)return;s.grid.canMoveNode(n,h,l,o,a)&&(s.grid.moveNode(n,h,l,o,a),s._updateContainerHeight())},l=function(e,o){s.container.append(s.placeholder);var a=t(this);s.grid.cleanNodes(),s.grid.beginUpdate(n),r=Math.ceil(a.outerWidth()/a.attr("data-gs-width"));var h=Math.ceil(a.outerHeight()/a.attr("data-gs-height"));d=s.container.height()/parseInt(s.container.attr("data-gs-current-height")),s.placeholder.attr("data-gs-x",a.attr("data-gs-x")).attr("data-gs-y",a.attr("data-gs-y")).attr("data-gs-width",a.attr("data-gs-width")).attr("data-gs-height",a.attr("data-gs-height")).show(),n.el=s.placeholder,n._beforeDragX=n.x,n._beforeDragY=n.y,i.resizable("option","minWidth",r*(n.minWidth||1)),i.resizable("option","minHeight",h*(n.minHeight||1)),"resizestart"==e.type&&a.find(".grid-stack-item").trigger("resizestart")},p=function(e,o){var a=!1;s.placeholder.detach();var r=t(this);n.el=r,s.placeholder.hide(),n._isAboutToRemove?(a=!0,i.removeData("_gridstack_node"),i.remove()):(s._clearRemovingTimeout(i),n._temporaryRemoved?(r.attr("data-gs-x",n._beforeDragX).attr("data-gs-y",n._beforeDragY).attr("data-gs-width",n.width).attr("data-gs-height",n.height).removeAttr("style"),n.x=n._beforeDragX,n.y=n._beforeDragY,s.grid.addNode(n)):r.attr("data-gs-x",n.x).attr("data-gs-y",n.y).attr("data-gs-width",n.width).attr("data-gs-height",n.height).removeAttr("style")),s._updateContainerHeight(),s._triggerChangeEvent(a),s.grid.endUpdate();var d=r.find(".grid-stack");d.length&&"resizestop"==e.type&&(d.each(function(e,i){t(i).data("gridstack").onResizeHandler()}),r.find(".grid-stack-item").trigger("resizestop"))};i.draggable(e.extend(this.opts.draggable,{containment:this.opts.isNested?this.container.parent():null,start:l,stop:p,drag:h})).resizable(e.extend(this.opts.resizable,{start:l,stop:p,resize:h})),(n.noMove||this._isOneColumnMode()||this.opts.staticGrid||this.opts.disableDrag)&&i.draggable("disable"),(n.noResize||this._isOneColumnMode()||this.opts.staticGrid||this.opts.disableResize)&&i.resizable("disable"),i.attr("data-gs-locked",n.locked?"yes":null)},d.prototype.setAnimation=function(t){t?this.container.addClass("grid-stack-animate"):this.container.removeClass("grid-stack-animate")},d.prototype.addWidget=function(e,i,o,s,a,n,r,d,h,l,p){return e=t(e),"undefined"!=typeof i&&e.attr("data-gs-x",i),"undefined"!=typeof o&&e.attr("data-gs-y",o),"undefined"!=typeof s&&e.attr("data-gs-width",s),"undefined"!=typeof a&&e.attr("data-gs-height",a),"undefined"!=typeof n&&e.attr("data-gs-auto-position",n?"yes":null),"undefined"!=typeof r&&e.attr("data-gs-min-width",r),"undefined"!=typeof d&&e.attr("data-gs-max-width",d),"undefined"!=typeof h&&e.attr("data-gs-min-height",h),"undefined"!=typeof l&&e.attr("data-gs-max-height",l),"undefined"!=typeof p&&e.attr("data-gs-id",p),this.container.append(e),this._prepareElement(e,!0),this._triggerAddEvent(),this._updateContainerHeight(),this._triggerChangeEvent(!0),e},d.prototype.makeWidget=function(e){return e=t(e),this._prepareElement(e,!0),this._triggerAddEvent(),this._updateContainerHeight(),this._triggerChangeEvent(!0),e},d.prototype.willItFit=function(t,e,i,o,s){var a={x:t,y:e,width:i,height:o,autoPosition:s};return this.grid.canBePlacedWithRespectToHeight(a)},d.prototype.removeWidget=function(e,i){i="undefined"==typeof i?!0:i,e=t(e);var o=e.data("_gridstack_node");o||(o=this.grid.getNodeDataByDOMEl(e)),this.grid.removeNode(o,i),e.removeData("_gridstack_node"),this._updateContainerHeight(),i&&e.remove(),this._triggerChangeEvent(!0),this._triggerRemoveEvent()},d.prototype.removeAll=function(t){e.each(this.grid.nodes,e.bind(function(e){this.removeWidget(e.el,t)},this)),this.grid.nodes=[],this._updateContainerHeight()},d.prototype.destroy=function(e){t(window).off("resize",this.onResizeHandler),this.disable(),"undefined"==typeof e||e?this.container.remove():this.removeAll(!1),a.removeStylesheet(this._stylesId),this.grid&&(this.grid=null)},d.prototype.resizable=function(e,i){var o=this;return e=t(e),e.each(function(e,s){s=t(s);var a=s.data("_gridstack_node");"undefined"!=typeof a&&null!==a&&(a.noResize=!i,a.noResize||o._isOneColumnMode()?s.resizable("disable"):s.resizable("enable"))}),this},d.prototype.movable=function(e,i){var o=this;return e=t(e),e.each(function(e,s){s=t(s);var a=s.data("_gridstack_node");"undefined"!=typeof a&&null!==a&&(a.noMove=!i,a.noMove||o._isOneColumnMode()?(s.draggable("disable"),s.removeClass("ui-draggable-handle")):(s.draggable("enable"),s.addClass("ui-draggable-handle")))}),this},d.prototype.enableMove=function(t,e){this.movable(this.container.children("."+this.opts.itemClass),t),e&&(this.opts.disableDrag=!t)},d.prototype.enableResize=function(t,e){this.resizable(this.container.children("."+this.opts.itemClass),t),e&&(this.opts.disableResize=!t)},d.prototype.disable=function(){this.movable(this.container.children("."+this.opts.itemClass),!1),this.resizable(this.container.children("."+this.opts.itemClass),!1),this.container.trigger("disable")},d.prototype.enable=function(){this.movable(this.container.children("."+this.opts.itemClass),!0),this.resizable(this.container.children("."+this.opts.itemClass),!0),this.container.trigger("enable")},d.prototype.locked=function(e,i){return e=t(e),e.each(function(e,o){o=t(o);var s=o.data("_gridstack_node");"undefined"!=typeof s&&null!==s&&(s.locked=i||!1,o.attr("data-gs-locked",s.locked?"yes":null))}),this},d.prototype.maxHeight=function(e,i){return e=t(e),e.each(function(e,o){o=t(o);var s=o.data("_gridstack_node");"undefined"!=typeof s&&null!==s&&(isNaN(i)||(s.maxHeight=i||!1,o.attr("data-gs-max-height",i)))}),this},d.prototype.minHeight=function(e,i){return e=t(e),e.each(function(e,o){o=t(o);var s=o.data("_gridstack_node");"undefined"!=typeof s&&null!==s&&(isNaN(i)||(s.minHeight=i||!1,o.attr("data-gs-min-height",i)))}),this},d.prototype.maxWidth=function(e,i){return e=t(e),e.each(function(e,o){o=t(o);var s=o.data("_gridstack_node");"undefined"!=typeof s&&null!==s&&(isNaN(i)||(s.maxWidth=i||!1,o.attr("data-gs-max-width",i)))}),this},d.prototype.minWidth=function(e,i){return e=t(e),e.each(function(e,o){o=t(o);var s=o.data("_gridstack_node");"undefined"!=typeof s&&null!==s&&(isNaN(i)||(s.minWidth=i||!1,o.attr("data-gs-min-width",i)))}),this},d.prototype._updateElement=function(e,i){e=t(e).first();var o=e.data("_gridstack_node");if("undefined"!=typeof o&&null!==o){var s=this;s.grid.cleanNodes(),s.grid.beginUpdate(o),i.call(this,e,o),s._updateContainerHeight(),s._triggerChangeEvent(),s.grid.endUpdate()}},d.prototype.resize=function(t,e,i){this._updateElement(t,function(t,o){e=null!==e&&"undefined"!=typeof e?e:o.width,i=null!==i&&"undefined"!=typeof i?i:o.height,this.grid.moveNode(o,o.x,o.y,e,i)})},d.prototype.move=function(t,e,i){this._updateElement(t,function(t,o){e=null!==e&&"undefined"!=typeof e?e:o.x,i=null!==i&&"undefined"!=typeof i?i:o.y,this.grid.moveNode(o,e,i,o.width,o.height)})},d.prototype.update=function(t,e,i,o,s){this._updateElement(t,function(t,a){e=null!==e&&"undefined"!=typeof e?e:a.x,i=null!==i&&"undefined"!=typeof i?i:a.y,o=null!==o&&"undefined"!=typeof o?o:a.width,s=null!==s&&"undefined"!=typeof s?s:a.height,this.grid.moveNode(a,e,i,o,s)})},d.prototype.verticalMargin=function(t,e){if("undefined"==typeof t)return this.opts.verticalMargin;var i=a.parseHeight(t);(this.opts.verticalMarginUnit!==i.unit||this.opts.height!==i.height)&&(this.opts.verticalMarginUnit=i.unit,this.opts.verticalMargin=i.height,e||this._updateStyles())},d.prototype.cellHeight=function(t,e){if("undefined"==typeof t){if(this.opts.cellHeight)return this.opts.cellHeight;var i=this.container.children("."+this.opts.itemClass).first();return Math.ceil(i.outerHeight()/i.attr("data-gs-height"))}var o=a.parseHeight(t);(this.opts.cellHeightUnit!==o.heightUnit||this.opts.height!==o.height)&&(this.opts.cellHeightUnit=o.unit,this.opts.cellHeight=o.height,e||this._updateStyles())},d.prototype.cellWidth=function(){var t=this.container.children("."+this.opts.itemClass).first();return Math.ceil(t.outerWidth()/parseInt(t.attr("data-gs-width"),10))},d.prototype.getCellFromPixel=function(t,e){var i="undefined"!=typeof e&&e?this.container.offset():this.container.position(),o=t.left-i.left,s=t.top-i.top,a=Math.floor(this.container.width()/this.opts.width),n=Math.floor(this.container.height()/parseInt(this.container.attr("data-gs-current-height")));return{x:Math.floor(o/a),y:Math.floor(s/n)}},d.prototype.batchUpdate=function(){this.grid.batchUpdate()},d.prototype.commit=function(){this.grid.commit(),this._updateContainerHeight()},d.prototype.isAreaEmpty=function(t,e,i,o){return this.grid.isAreaEmpty(t,e,i,o)},d.prototype.setStatic=function(t){this.opts.staticGrid=t===!0,this.enableMove(!t),this.enableResize(!t),this._setStaticClass()},d.prototype._setStaticClass=function(){var t="grid-stack-static";this.opts.staticGrid===!0?this.container.addClass(t):this.container.removeClass(t)},d.prototype._updateNodeWidths=function(t,e){this.grid._sortNodes(),this.grid.batchUpdate();for(var i={},o=0;o<this.grid.nodes.length;o++)i=this.grid.nodes[o],this.update(i.el,Math.round(i.x*e/t),void 0,Math.round(i.width*e/t),void 0);this.grid.commit()},d.prototype.setGridWidth=function(t,e){this.container.removeClass("grid-stack-"+this.opts.width),e!==!0&&this._updateNodeWidths(this.opts.width,t),this.opts.width=t,this.grid.width=t,this.container.addClass("grid-stack-"+t)},r.prototype.batch_update=o(r.prototype.batchUpdate),r.prototype._fix_collisions=o(r.prototype._fixCollisions,"_fix_collisions","_fixCollisions"),r.prototype.is_area_empty=o(r.prototype.isAreaEmpty,"is_area_empty","isAreaEmpty"),r.prototype._sort_nodes=o(r.prototype._sortNodes,"_sort_nodes","_sortNodes"),r.prototype._pack_nodes=o(r.prototype._packNodes,"_pack_nodes","_packNodes"),r.prototype._prepare_node=o(r.prototype._prepareNode,"_prepare_node","_prepareNode"),r.prototype.clean_nodes=o(r.prototype.cleanNodes,"clean_nodes","cleanNodes"),r.prototype.get_dirty_nodes=o(r.prototype.getDirtyNodes,"get_dirty_nodes","getDirtyNodes"),r.prototype.add_node=o(r.prototype.addNode,"add_node","addNode, "),r.prototype.remove_node=o(r.prototype.removeNode,"remove_node","removeNode"),r.prototype.can_move_node=o(r.prototype.canMoveNode,"can_move_node","canMoveNode"),r.prototype.move_node=o(r.prototype.moveNode,"move_node","moveNode"),r.prototype.get_grid_height=o(r.prototype.getGridHeight,"get_grid_height","getGridHeight"),r.prototype.begin_update=o(r.prototype.beginUpdate,"begin_update","beginUpdate"),r.prototype.end_update=o(r.prototype.endUpdate,"end_update","endUpdate"),r.prototype.can_be_placed_with_respect_to_height=o(r.prototype.canBePlacedWithRespectToHeight,"can_be_placed_with_respect_to_height","canBePlacedWithRespectToHeight"),d.prototype._trigger_change_event=o(d.prototype._triggerChangeEvent,"_trigger_change_event","_triggerChangeEvent"),d.prototype._init_styles=o(d.prototype._initStyles,"_init_styles","_initStyles"),d.prototype._update_styles=o(d.prototype._updateStyles,"_update_styles","_updateStyles"),d.prototype._update_container_height=o(d.prototype._updateContainerHeight,"_update_container_height","_updateContainerHeight"),d.prototype._is_one_column_mode=o(d.prototype._isOneColumnMode,"_is_one_column_mode","_isOneColumnMode"),d.prototype._prepare_element=o(d.prototype._prepareElement,"_prepare_element","_prepareElement"),d.prototype.set_animation=o(d.prototype.setAnimation,"set_animation","setAnimation"),d.prototype.add_widget=o(d.prototype.addWidget,"add_widget","addWidget"),d.prototype.make_widget=o(d.prototype.makeWidget,"make_widget","makeWidget"),d.prototype.will_it_fit=o(d.prototype.willItFit,"will_it_fit","willItFit"),d.prototype.remove_widget=o(d.prototype.removeWidget,"remove_widget","removeWidget"),d.prototype.remove_all=o(d.prototype.removeAll,"remove_all","removeAll"),d.prototype.min_height=o(d.prototype.minHeight,"min_height","minHeight"),d.prototype.min_width=o(d.prototype.minWidth,"min_width","minWidth"),d.prototype._update_element=o(d.prototype._updateElement,"_update_element","_updateElement"),d.prototype.cell_height=o(d.prototype.cellHeight,"cell_height","cellHeight"),d.prototype.cell_width=o(d.prototype.cellWidth,"cell_width","cellWidth"),d.prototype.get_cell_from_pixel=o(d.prototype.getCellFromPixel,"get_cell_from_pixel","getCellFromPixel"),d.prototype.batch_update=o(d.prototype.batchUpdate,"batch_update","batchUpdate"),d.prototype.is_area_empty=o(d.prototype.isAreaEmpty,"is_area_empty","isAreaEmpty"),d.prototype.set_static=o(d.prototype.setStatic,"set_static","setStatic"),d.prototype._set_static_class=o(d.prototype._setStaticClass,"_set_static_class","_setStaticClass"),i.GridStackUI=d,i.GridStackUI.Utils=a,i.GridStackUI.Engine=r,t.fn.gridstack=function(e){return this.each(function(){var i=t(this);i.data("gridstack")||i.data("gridstack",new d(this,e))})},i.GridStackUI});